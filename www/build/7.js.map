{"version":3,"sources":["../../src/pages/checkout/checkout.module.ts","../../src/pages/checkout/checkout.ts"],"names":[],"mappings":"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","file":"7.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { Checkout } from './checkout';\n\n@NgModule({\n  declarations: [\n    Checkout,\n  ],\n  imports: [\n    IonicPageModule.forChild(Checkout),\n  ],\n  exports: [\n    Checkout\n  ]\n})\nexport class CheckoutPageModule {}\n\n\n// WEBPACK FOOTER //\n// ./src/pages/checkout/checkout.module.ts","import { Component } from '@angular/core';\nimport { IonicPage, NavController, NavParams, AlertController } from 'ionic-angular';\nimport { Storage } from '@ionic/storage';\nimport * as WC from 'woocommerce-api';\n// import { HomePage } from '../home/home';\n// import { Menu } from '../menu/menu';\nimport { PayPal, PayPalPayment, PayPalConfiguration } from '@ionic-native/paypal';\nimport { WoocommerceProvider } from '../../providers/woocommerce/woocommerce';\n\n@IonicPage({})\n@Component({\n  selector: 'page-checkout',\n  templateUrl: 'checkout.html',\n})\nexport class Checkout {\n\n  WooCommerce: any;\n  newOrder: any;\n  paymentMethods: any[];\n  paymentMethod: any;\n  billing_shipping_same: boolean;\n  userInfo: any;\n\n  constructor(public navCtrl: NavController, public navParams: NavParams, public storage: Storage, public alertCtrl: AlertController, public payPal: PayPal, private WP: WoocommerceProvider) {\n    this.newOrder = {};\n    this.newOrder.billing = {};\n    this.newOrder.shipping = {};\n    this.billing_shipping_same = false;\n\n    this.paymentMethods = [\n      { method_id: \"bacs\", method_title: \"Direct Bank Transfer\" },\n      { method_id: \"cheque\", method_title: \"Cheque Payment\" },\n      { method_id: \"cod\", method_title: \"Cash on Delivery\" },\n      { method_id: \"paypal\", method_title: \"PayPal\" }];\n\n    this.WooCommerce = WP.init(true);\n\n    this.storage.get(\"userLoginInfo\").then((userLoginInfo) => {\n\n      this.userInfo = userLoginInfo.user;\n\n      let email = userLoginInfo.user.email;\n      let id = userLoginInfo.user.id;\n\n      this.WooCommerce.getAsync(\"customers/\"+id).then((data) => {\n\n        this.newOrder = JSON.parse(data.body);\n\n      })\n\n    })\n\n  }\n\n  setBillingToShipping() {\n    this.billing_shipping_same = !this.billing_shipping_same;\n\n    if (this.billing_shipping_same) {\n      this.newOrder.shipping = this.newOrder.billing;\n    }\n\n  }\n\n  placeOrder() {\n\n    let orderItems: any[] = [];\n    let data: any = {};\n\n    let paymentData: any = {};\n\n    this.paymentMethods.forEach((element, index) => {\n      if (element.method_id == this.paymentMethod) {\n        paymentData = element;\n      }\n    });\n\n\n    data = {\n\n      //Fixed a bug here. Updated in accordance with wc/v2 API\n      payment_method: paymentData.method_id,\n      payment_method_title: paymentData.method_title,\n      set_paid: true,\n\n      billing: this.newOrder.billing,\n      shipping: this.newOrder.shipping,\n      customer_id: this.userInfo.id || '',\n      line_items: orderItems\n    };\n\n\n    if (paymentData.method_id == \"paypal\") {\n\n      this.payPal.init({\n        PayPalEnvironmentProduction: \"YOUR_PRODUCTION_CLIENT_ID\",\n        PayPalEnvironmentSandbox: \"AYkkS2ObeSpaObaCqA3bybQjRNRMKOw_2vNSha7gmxESpG4l4AhEyMfYwuzrUFKSbWGhCsN-Vhtl5FOG\"\n      }).then(() => {\n        // Environments: PayPalEnvironmentNoNetwork, PayPalEnvironmentSandbox, PayPalEnvironmentProduction\n        this.payPal.prepareToRender('PayPalEnvironmentSandbox', new PayPalConfiguration({\n          // Only needed if you get an \"Internal Service Error\" after PayPal login!\n          //payPalShippingAddressOption: 2 // PayPalShippingAddressOptionPayPal\n        })).then(() => {\n\n          this.storage.get(\"cart\").then((cart) => {\n\n            let total = 0.00;\n            cart.forEach((element, index) => {\n\n              if(element.variation){\n                orderItems.push({ product_id: element.product.id, variation_id: element.variation.id, quantity: element.qty });\n                total = total + (element.variation.price * element.qty);\n              } else {\n                orderItems.push({ product_id: element.product.id, quantity: element.qty });\n                total = total + (element.product.price * element.qty);\n              }\n            });\n\n            let payment = new PayPalPayment(total.toString(), 'USD', 'Description', 'sale');\n            this.payPal.renderSinglePaymentUI(payment).then((response) => {\n              // Successfully paid\n\n              alert(JSON.stringify(response));\n\n\n              data.line_items = orderItems;\n              //console.log(data);\n              let orderData: any = {};\n\n              orderData.order = data;\n\n              this.WooCommerce.postAsync('orders', orderData.order).then((data) => {\n                alert(\"Order placed successfully!\");\n\n                let response = (JSON.parse(data.body));\n\n                this.alertCtrl.create({\n                  title: \"Order Placed Successfully\",\n                  message: \"Your order has been placed successfully. Your order number is \" + response.order_number,\n                  buttons: [{\n                    text: \"OK\",\n                    handler: () => {\n                      this.navCtrl.push('HomePage');\n                    }\n                  }]\n                }).present();\n              })\n\n            })\n\n          }, () => {\n            // Error or render dialog closed without being successful\n          });\n        }, () => {\n          // Error in configuration\n        });\n      }, () => {\n        // Error in initialization, maybe PayPal isn't supported or something else\n      });\n\n\n\n\n\n    } else {\n\n      this.storage.get(\"cart\").then((cart) => {\n\n        cart.forEach((element, index) => {\n          if(element.variation){\n            orderItems.push({ product_id: element.product.id, variation_id: element.variation.id, quantity: element.qty });\n            ///total = total + (element.variation.price * element.qty);\n          } else {\n            orderItems.push({ product_id: element.product.id, quantity: element.qty });\n            ///total = total + (element.product.price * element.qty);\n          }\n        });\n\n        data.line_items = orderItems;\n\n        let orderData: any = {};\n\n        orderData.order = data;\n\n        this.WooCommerce.postAsync(\"orders\", orderData.order).then((data) => {\n\n          let response = (JSON.parse(data.body));\n\n          this.alertCtrl.create({\n            title: \"Order Placed Successfully\",\n            message: \"Your order has been placed successfully. Your order number is \" + response.order_number,\n            buttons: [{\n              text: \"OK\",\n              handler: () => {\n                this.navCtrl.setRoot('HomePage');\n              }\n            }]\n          }).present();\n\n        })\n\n      })\n\n    }\n\n\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/checkout/checkout.ts"],"sourceRoot":""}